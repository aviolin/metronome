(this["webpackJsonpmy-react-app"]=this["webpackJsonpmy-react-app"]||[]).push([[0],{14:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a(4),s=a(5),o=a(3),c=a(7),r=a(6),l=a(2),h=a.n(l),u=a(13),p=a.n(u),d=a(8),m=a(10);function b(e){var t=Object(i.jsx)(m.a,{icon:d.b}),a=Object(i.jsx)(m.a,{icon:d.c});return Object(i.jsx)("button",{className:"button-play",onClick:e.onClick,name:"play-button",children:"Start"===e.value?t:a})}function j(e){return Object(i.jsx)("input",{type:"range",id:"tempo",min:"30",max:"300",step:"1",value:e.tempo,onChange:e.onChange})}var v=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={},i.canvasRef=h.a.createRef(),i.resetCanvas=i.resetCanvas.bind(Object(o.a)(i)),window.onorientationchange=i.resetCanvas,window.onresize=i.resetCanvas,i}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.drawCanvas(),this.resetCanvas()}},{key:"componentDidUpdate",value:function(){this.drawCanvas()}},{key:"resetCanvas",value:function(){this.canvasRef.current.width=window.innerWidth,this.canvasRef.current.height=window.innerHeight,window.scrollTo(0,0)}},{key:"drawCanvas",value:function(){var e=this.canvasRef.current,t=e.getContext("2d"),a="#333";if(t.fillStyle=a,t.globalAlpha=1,t.fillRect(0,0,e.width,e.height),this.props.isplaying){var i=(60/this.props.tempo-(this.props.nextnotetime-this.props.currenttime))/(60/this.props.tempo);i<0&&(i=0),a="#dd77dd",!0===this.props.tick&&(a="#eee"),t.strokeStyle=a,t.globalAlpha=1-i,t.beginPath(),t.lineWidth=100-100*i,t.arc(e.width/2,e.height/3,200*i,0,2*Math.PI),t.stroke(),t.fillStyle="#ffaaff",t.fill()}}},{key:"render",value:function(){return Object(i.jsx)("canvas",{ref:this.canvasRef,id:"canvas",height:"100",width:"100"})}}]),a}(h.a.Component),x=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={tick:!1,lastNoteDrawn:null,alpha:0,percentToNextNote:0,nextNoteTime:0},i.updateAnimation=i.updateAnimation.bind(Object(o.a)(i)),i}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.rAF=requestAnimationFrame(this.updateAnimation)}},{key:"updateAnimation",value:function(){if(this.props.isplaying){for(var e=this.props.audiocontext.currentTime,t=this.props.queue,a=this.state.lastNoteDrawn;t.length&&t[0].time<e;)a=t[0],t.splice(0,1);a!==this.state.lastNoteDrawn?this.setState((function(e,t){return{tick:!0,alpha:1,percentToNextNote:0,nextNoteTime:a.time+60/t.tempo}})):this.setState((function(e,t){return{tick:!1,alpha:e.alpha-.1<0?0:e.alpha-.1}}))}else this.setState((function(e){return{tick:!1,alpha:e.alpha-.1<0?0:e.alpha-.1}}));this.rAF=requestAnimationFrame(this.updateAnimation)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rAF)}},{key:"render",value:function(){return Object(i.jsx)(v,{tick:this.state.tick,tempo:this.props.tempo,nextnotetime:this.state.nextNoteTime,alpha:this.state.alpha,currenttime:this.props.audiocontext.currentTime,isplaying:this.props.isplaying})}}]),a}(h.a.Component),f=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(n.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){return Object(i.jsxs)("div",{className:"tempo-inputs",children:[Object(i.jsxs)("div",{className:"tempo-input-row",children:[Object(i.jsx)("button",{className:"button-tempo large",name:"decrement-tempo",onClick:this.props.onClick,children:"-"}),Object(i.jsxs)("div",{className:"tempo-label",children:[Object(i.jsx)("span",{className:"large",children:this.props.tempo})," BPM"]}),Object(i.jsx)("button",{className:"button-tempo large",name:"increment-tempo",onClick:this.props.onClick,children:"+"})]}),Object(i.jsx)(j,{onChange:this.props.onChange,tempo:this.props.tempo})]})}}]),a}(h.a.Component);function O(e){var t=Object(i.jsx)("input",{className:"checkbox",type:"radio",id:e.id+"-"+e.value,name:e.id,value:e.value});return e.default===e.id&&(t=Object(i.jsx)("input",{className:"checkbox",type:"radio",id:e.id+"-"+e.value,name:e.id,value:e.value,defaultChecked:!0})),Object(i.jsxs)("span",{children:[t,Object(i.jsx)("label",{htmlFor:e.id+"-"+e.value,children:e.value})]})}var k=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(n.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.label;return this.props.value>1&&(e="beats"===this.props.id?" beats per bar":" clicks per beat"),Object(i.jsxs)("div",{className:"radio-input-section",children:[Object(i.jsxs)("div",{className:"label",children:[Object(i.jsx)("b",{children:this.props.value}),e]}),Object(i.jsxs)("div",{className:"radio-scrollable",onChange:this.props.onChange,children:[Object(i.jsx)(O,{value:"1",id:this.props.id,default:"clicks"}),Object(i.jsx)(O,{value:"2",id:this.props.id}),Object(i.jsx)(O,{value:"3",id:this.props.id}),Object(i.jsx)(O,{value:"4",id:this.props.id,default:"beats"}),Object(i.jsx)(O,{value:"5",id:this.props.id}),Object(i.jsx)(O,{value:"6",id:this.props.id}),Object(i.jsx)(O,{value:"7",id:this.props.id}),Object(i.jsx)(O,{value:"8",id:this.props.id}),Object(i.jsx)(O,{value:"9",id:this.props.id}),Object(i.jsx)(O,{value:"10",id:this.props.id}),Object(i.jsx)(O,{value:"11",id:this.props.id}),Object(i.jsx)(O,{value:"12",id:this.props.id})]})]})}}]),a}(h.a.Component),g=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={tempo:120,maxTempo:300,minTempo:30,beatsPerBar:4,clicksPerBeat:1,nextBeat:0,nextClick:0,isPlaying:!1,lookahead:25,scheduleAheadTime:.1,nextNoteTime:0,noteLength:.1,audioUnlocked:!1,noteQueue:[]},i.handleChange=i.handleChange.bind(Object(o.a)(i)),i.handleClick=i.handleClick.bind(Object(o.a)(i)),i.handleTick=i.handleTick.bind(Object(o.a)(i)),i.audioContext=new AudioContext,i.timerWorker=new Worker("/worker.js"),i.timerWorker.onmessage=function(e){"tick"===e.data?i.handleTick():console.log("message: "+e.data)},i.timerWorker.postMessage({interval:i.state.lookahead}),i}return Object(s.a)(a,[{key:"scheduleNote",value:function(e){console.log("Scheduling note to be played at: "+this.state.nextNoteTime);var t=this.audioContext.createOscillator(),a=this.audioContext.createGain();t.connect(a),a.connect(this.audioContext.destination),0!=e.beat?t.frequency.value=440:t.frequency.value=880,0!=e.click&&(t.frequency.value=330),t.start(this.state.nextNoteTime),a.gain.setTargetAtTime(0,this.state.nextNoteTime+this.state.noteLength,.015),t.stop(this.state.nextNoteTime+2*this.state.noteLength)}},{key:"handleTick",value:function(){for(var e=this,t=function(){var t=e.state.nextBeat,a=e.state.nextClick,i=new y(e.state.nextNoteTime,t,a);e.scheduleNote(i),e.state.clicksPerBeat>1?++a>=e.state.clicksPerBeat&&(a=0,++t>=e.state.beatsPerBar&&(t=0)):++t>=e.state.beatsPerBar&&(t=0),e.setState((function(e){var n=e.noteQueue.concat(i),s=60/e.tempo;return{noteQueue:n,nextNoteTime:e.nextNoteTime+1/e.clicksPerBeat*s,nextBeat:t,nextClick:a}}))};this.state.nextNoteTime<this.audioContext.currentTime+this.state.scheduleAheadTime;)t()}},{key:"handleClick",value:function(e){if("increment-tempo"!==e.target.name)if("decrement-tempo"!==e.target.name){if(this.audioContext=new AudioContext,this.timerWorker.postMessage(this.state.isPlaying?"stop":"start"),!this.state.audioUnlocked){var t=this.audioContext.createBuffer(1,1,22050),a=this.audioContext.createBufferSource();a.buffer=t,a.start(this.audioContext.currentTime)}this.setState((function(e){return{isPlaying:!e.isPlaying,audioUnlocked:!0,noteQueue:[],nextNoteTime:0,nextBeat:0,nextClick:0}}))}else this.setState((function(e){return{tempo:e.tempo-1<e.minTempo?e.tempo:e.tempo-1}}));else this.setState((function(e){return{tempo:e.tempo+1>e.maxTempo?e.tempo:e.tempo+1}}))}},{key:"handleChange",value:function(e){"beats"===e.target.name?this.setState({beatsPerBar:e.target.value}):"clicks"===e.target.name?this.setState({clicksPerBeat:e.target.value}):this.setState({tempo:e.target.value})}},{key:"render",value:function(){return Object(i.jsxs)("div",{className:"metronome",children:[Object(i.jsx)(x,{tempo:this.state.tempo,isplaying:this.state.isPlaying,queue:this.state.noteQueue,audiocontext:this.audioContext}),Object(i.jsxs)("div",{className:"inputs",children:[Object(i.jsx)(b,{value:this.state.isPlaying?"Stop":"Start",onClick:this.handleClick}),Object(i.jsx)(f,{onChange:this.handleChange,tempo:this.state.tempo,onClick:this.handleClick}),Object(i.jsx)(k,{label:" beat per bar",id:"beats",onChange:this.handleChange,value:this.state.beatsPerBar}),Object(i.jsx)(k,{label:" click per beat",id:"clicks",onChange:this.handleChange,value:this.state.clicksPerBeat})]})]})}}]),a}(h.a.Component),C=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(n.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){return Object(i.jsxs)("div",{className:"navbar",children:[Object(i.jsx)("div",{className:"logo",children:"Zen Metronome"}),Object(i.jsx)("button",{className:"button-theme-toggle",children:Object(i.jsx)(m.a,{icon:d.a})})]})}}]),a}(h.a.Component),y=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(n.a)(this,e),this.time=t,this.beat=a,this.click=i};p.a.render(Object(i.jsxs)(h.a.StrictMode,{children:[Object(i.jsx)(C,{}),Object(i.jsx)(g,{})]}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.68b15605.chunk.js.map