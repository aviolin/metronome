(this["webpackJsonpmy-react-app"]=this["webpackJsonpmy-react-app"]||[]).push([[0],{14:function(e,t,a){var n=a(21),i=[];e.exports=function(){var e=new Worker(a.p+"c737dd0979893d18313b.worker.js",{name:"[hash].worker.js"});return n(e,i),e}},15:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(4),s=a(5),o=a(3),c=a(7),r=a(6),l=a(2),h=a.n(l),u=a(13),p=a.n(u),d=a(14),m=a.n(d),b=(a(22),a(8)),j=a(10);function v(e){var t=Object(n.jsx)(j.a,{icon:b.b}),a=Object(n.jsx)(j.a,{icon:b.c});return Object(n.jsx)("button",{className:"button-play",onClick:e.onClick,name:"play-button",children:"Start"===e.value?t:a})}function x(e){return Object(n.jsx)("input",{type:"range",id:"tempo",min:"30",max:"300",step:"1",value:e.tempo,onChange:e.onChange})}var f=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={},n.canvasRef=h.a.createRef(),n.resetCanvas=n.resetCanvas.bind(Object(o.a)(n)),window.onorientationchange=n.resetCanvas,window.onresize=n.resetCanvas,n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.drawCanvas(),this.resetCanvas()}},{key:"componentDidUpdate",value:function(){this.drawCanvas()}},{key:"resetCanvas",value:function(){this.canvasRef.current.width=window.innerWidth,this.canvasRef.current.height=window.innerHeight,window.scrollTo(0,0)}},{key:"drawCanvas",value:function(){var e=this.canvasRef.current,t=e.getContext("2d"),a="#333";if(t.fillStyle=a,t.globalAlpha=1,t.fillRect(0,0,e.width,e.height),this.props.isplaying){var n=(60/this.props.tempo-(this.props.nextnotetime-this.props.currenttime))/(60/this.props.tempo);n<0&&(n=0),a="#dd77dd",!0===this.props.tick&&(a="#eee"),t.strokeStyle=a,t.globalAlpha=1-n,t.beginPath(),t.lineWidth=100-100*n,t.arc(e.width/2,e.height/3,200*n,0,2*Math.PI),t.stroke(),t.fillStyle="#ffaaff",t.fill()}}},{key:"render",value:function(){return Object(n.jsx)("canvas",{ref:this.canvasRef,id:"canvas",height:"100",width:"100"})}}]),a}(h.a.Component),k=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={tick:!1,lastNoteDrawn:null,alpha:0,percentToNextNote:0,nextNoteTime:0},n.updateAnimation=n.updateAnimation.bind(Object(o.a)(n)),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.rAF=requestAnimationFrame(this.updateAnimation)}},{key:"updateAnimation",value:function(){if(this.props.isplaying){for(var e=this.props.audiocontext.currentTime,t=this.props.queue,a=this.state.lastNoteDrawn;t.length&&t[0].time<e;)a=t[0],t.splice(0,1);a!==this.state.lastNoteDrawn?this.setState((function(e,t){return{tick:!0,alpha:1,percentToNextNote:0,nextNoteTime:a.time+60/t.tempo}})):this.setState((function(e,t){return{tick:!1,alpha:e.alpha-.1<0?0:e.alpha-.1}}))}else this.setState((function(e){return{tick:!1,alpha:e.alpha-.1<0?0:e.alpha-.1}}));this.rAF=requestAnimationFrame(this.updateAnimation)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rAF)}},{key:"render",value:function(){return Object(n.jsx)(f,{tick:this.state.tick,tempo:this.props.tempo,nextnotetime:this.state.nextNoteTime,alpha:this.state.alpha,currenttime:this.props.audiocontext.currentTime,isplaying:this.props.isplaying})}}]),a}(h.a.Component),O=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"tempo-inputs",children:[Object(n.jsxs)("div",{className:"tempo-input-row",children:[Object(n.jsx)("button",{className:"button-tempo large",name:"decrement-tempo",onClick:this.props.onClick,children:"-"}),Object(n.jsxs)("div",{className:"tempo-label",children:[Object(n.jsx)("span",{className:"large",children:this.props.tempo})," BPM"]}),Object(n.jsx)("button",{className:"button-tempo large",name:"increment-tempo",onClick:this.props.onClick,children:"+"})]}),Object(n.jsx)(x,{onChange:this.props.onChange,tempo:this.props.tempo})]})}}]),a}(h.a.Component);function g(e){var t=Object(n.jsx)("input",{className:"checkbox",type:"radio",id:e.id+"-"+e.value,name:e.id,value:e.value});return e.default===e.id&&(t=Object(n.jsx)("input",{className:"checkbox",type:"radio",id:e.id+"-"+e.value,name:e.id,value:e.value,defaultChecked:!0})),Object(n.jsxs)("span",{children:[t,Object(n.jsx)("label",{htmlFor:e.id+"-"+e.value,children:e.value})]})}var C=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.label;return this.props.value>1&&(e="beats"===this.props.id?" beats per bar":" clicks per beat"),Object(n.jsxs)("div",{className:"radio-input-section",children:[Object(n.jsxs)("div",{className:"label",children:[Object(n.jsx)("b",{children:this.props.value}),e]}),Object(n.jsxs)("div",{className:"radio-scrollable",onChange:this.props.onChange,children:[Object(n.jsx)(g,{value:"1",id:this.props.id,default:"clicks"}),Object(n.jsx)(g,{value:"2",id:this.props.id}),Object(n.jsx)(g,{value:"3",id:this.props.id}),Object(n.jsx)(g,{value:"4",id:this.props.id,default:"beats"}),Object(n.jsx)(g,{value:"5",id:this.props.id}),Object(n.jsx)(g,{value:"6",id:this.props.id}),Object(n.jsx)(g,{value:"7",id:this.props.id}),Object(n.jsx)(g,{value:"8",id:this.props.id}),Object(n.jsx)(g,{value:"9",id:this.props.id}),Object(n.jsx)(g,{value:"10",id:this.props.id}),Object(n.jsx)(g,{value:"11",id:this.props.id}),Object(n.jsx)(g,{value:"12",id:this.props.id})]})]})}}]),a}(h.a.Component),y=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={tempo:120,maxTempo:300,minTempo:30,beatsPerBar:4,clicksPerBeat:1,nextBeat:0,nextClick:0,isPlaying:!1,lookahead:25,scheduleAheadTime:.1,nextNoteTime:0,noteLength:.1,audioUnlocked:!1,noteQueue:[]},n.handleChange=n.handleChange.bind(Object(o.a)(n)),n.handleClick=n.handleClick.bind(Object(o.a)(n)),n.handleTick=n.handleTick.bind(Object(o.a)(n)),n.audioContext=new AudioContext,n.timerWorker=m()(),n.timerWorker.onmessage=function(e){"tick"===e.data?n.handleTick():console.log("message: "+e.data)},n.timerWorker.postMessage({interval:n.state.lookahead}),n}return Object(s.a)(a,[{key:"scheduleNote",value:function(e){console.log("Scheduling note to be played at: "+this.state.nextNoteTime);var t=this.audioContext.createOscillator(),a=this.audioContext.createGain();t.connect(a),a.connect(this.audioContext.destination),0!=e.beat?t.frequency.value=440:t.frequency.value=880,0!=e.click&&(t.frequency.value=330),t.start(this.state.nextNoteTime),a.gain.setTargetAtTime(0,this.state.nextNoteTime+this.state.noteLength,.015),t.stop(this.state.nextNoteTime+2*this.state.noteLength)}},{key:"handleTick",value:function(){for(var e=this,t=function(){var t=e.state.nextBeat,a=e.state.nextClick,n=new T(e.state.nextNoteTime,t,a);e.scheduleNote(n),e.state.clicksPerBeat>1?++a>=e.state.clicksPerBeat&&(a=0,++t>=e.state.beatsPerBar&&(t=0)):++t>=e.state.beatsPerBar&&(t=0),e.setState((function(e){var i=e.noteQueue.concat(n),s=60/e.tempo;return{noteQueue:i,nextNoteTime:e.nextNoteTime+1/e.clicksPerBeat*s,nextBeat:t,nextClick:a}}))};this.state.nextNoteTime<this.audioContext.currentTime+this.state.scheduleAheadTime;)t()}},{key:"handleClick",value:function(e){if("increment-tempo"!==e.target.name)if("decrement-tempo"!==e.target.name){if(this.audioContext=new AudioContext,this.timerWorker.postMessage(this.state.isPlaying?"stop":"start"),!this.state.audioUnlocked){var t=this.audioContext.createBuffer(1,1,22050),a=this.audioContext.createBufferSource();a.buffer=t,a.start(this.audioContext.currentTime)}this.setState((function(e){return{isPlaying:!e.isPlaying,audioUnlocked:!0,noteQueue:[],nextNoteTime:0,nextBeat:0,nextClick:0}}))}else this.setState((function(e){return{tempo:e.tempo-1<e.minTempo?e.tempo:e.tempo-1}}));else this.setState((function(e){return{tempo:e.tempo+1>e.maxTempo?e.tempo:e.tempo+1}}))}},{key:"handleChange",value:function(e){"beats"===e.target.name?this.setState({beatsPerBar:e.target.value}):"clicks"===e.target.name?this.setState({clicksPerBeat:e.target.value}):this.setState({tempo:e.target.value})}},{key:"render",value:function(){return Object(n.jsxs)("div",{className:"metronome",children:[Object(n.jsx)(k,{tempo:this.state.tempo,isplaying:this.state.isPlaying,queue:this.state.noteQueue,audiocontext:this.audioContext}),Object(n.jsxs)("div",{className:"inputs",children:[Object(n.jsx)(v,{value:this.state.isPlaying?"Stop":"Start",onClick:this.handleClick}),Object(n.jsx)(O,{onChange:this.handleChange,tempo:this.state.tempo,onClick:this.handleClick}),Object(n.jsx)(C,{label:" beat per bar",id:"beats",onChange:this.handleChange,value:this.state.beatsPerBar}),Object(n.jsx)(C,{label:" click per beat",id:"clicks",onChange:this.handleChange,value:this.state.clicksPerBeat})]})]})}}]),a}(h.a.Component),N=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(i.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"navbar",children:[Object(n.jsx)("div",{className:"logo",children:"Zen Metronome"}),Object(n.jsx)("button",{className:"button-theme-toggle",children:Object(n.jsx)(j.a,{icon:b.a})})]})}}]),a}(h.a.Component),T=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(i.a)(this,e),this.time=t,this.beat=a,this.click=n};p.a.render(Object(n.jsxs)(h.a.StrictMode,{children:[Object(n.jsx)(N,{}),Object(n.jsx)(y,{})]}),document.getElementById("root"))},22:function(e,t,a){}},[[15,1,2]]]);
//# sourceMappingURL=main.48f1a574.chunk.js.map